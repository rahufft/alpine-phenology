{
    "contents" : "\nlibrary(grDevices)\n\nsetwd(path.expand(\"Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_QGIS Projects/Alpine Phenology Project/Final_R_Input_Data/\"))\n\n#Bring in Q:\\Research\\All_Projects_by_Species\\aa_Shapefiles_Maps\\aa_QGIS Projects\n#\t\t\\aa_QGIS Projects\\Alpine Phenology Project\\Final_R_Data\\QR_final_R_plant_climate_data\nbloom<-read.csv(\"QR_final_R_plant_climate_data.csv\",        \n                header = TRUE, as.is=TRUE)        \nhead(bloom)\nnames(bloom)\nstr(bloom)  #tells me column name, data type and examples, 8102 obs.\n\n#Limit all data to after 1949, 7220 obs. from table (7217 obs. from query in Access)\nbl50 <- subset(bloom, bloom$year_plant > 1949)\nstr(bl50)\nhead(bl50)\n\n# Pull out the earliest bloom date per year per species\nfoo <- function(x){min(bl50$startDayOfYear~bl50$Year)}\n\n\n names <- unique(bl50$Scientific.Name)\t\t# Names includes synonyms, sspListID contains unique taxa\n namesID <- unique(bl50$sppListID)\nlength(namesID)\t# 290\nhead(namesID)\n\nnames(bl50)\ntable(bl50$sppListID, bl50$startDayOfYear)\n\n# testing\n#namesID <- 3\n#vari <- \"Year\"\n\n\n#_________________________________________________________________________\n\nJulBloomDate <- function(vari){\t#vari <- \"Year\"; \nsetwd(path.expand(\"Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_QGIS Projects/Alpine Phenology Project/R_figures_alpine\"))\n\tnamesID <- unique(bl50$sppListID)\n\trm(JYC)\n\tJYC <- c()\n\tstats<-c()\n\n\tfor(i in namesID){\n\t\tspsub <- subset(bl50, sppListID == i)\t\n\t\tpyr <- tapply(spsub$startDayOfYear, spsub$Year, min)\n\t\tval <- as.vector(pyr)\n\t\tyrs <- as.numeric(names(pyr))\n\t\tmins <- data.frame(cbind(julian = val, Year = yrs))\n\t\t\tblnew <- c()\n\t\t\t\tfor(j in 1:nrow(mins)){\n\t\t\t\t\tblnew <- rbind(blnew, \n\t\t\t\t\t\tsubset(spsub, \n\t\t\t\t\t\t\tspsub$startDayOfYear == mins[j,1] \n\t\t\t\t\t\t\t& spsub$Year == mins[j,2]))\n\t\t\t}\n\tblnew <- blnew[!duplicated(blnew[,c('earliestBloomDate','Year')]),]\t#get rid of duplicates for a year\n\tjpeg(filename = paste(blnew$Scientific.Name[1], vari, \".jpg\"),\n\t\tquality = 100)\ncolnum <- match(vari,names(blnew))\n\tplot(blnew[,colnum], blnew$startDayOfYear, \n\t\tmain = paste(blnew$Scientific.Name[1], vari, sep = \"\"), \n\t\tcex.main = 0.85,\n\t\txlab = paste(vari),\n\t\tylab = \"Julian date of first bloom\")\nabline(lm(blnew$startDayOfYear~blnew[,colnum]))\ndev.off()\ngraphics.off()\nfoo1 <- summary(lm(blnew$startDayOfYear~blnew[,colnum]))\njul.yr.coef <- data.frame(\n\t\t\tcbind(\n\t\t\t\tdata.frame(t(foo1$coefficients[2,])),\n\t\t\t\tfoo1$coefficients[1,1],\n\t\t\t\tt(foo1$fstatistic),\n\t\t\t\tSpecies = blnew$Scientific.Name[1],\n\t\t\t\tfoo1$adj.r.squared))\nJYC <- rbind(JYC, jul.yr.coef)\n}\n\nstr(JYC)\ncolnames(JYC) <- c(\"Slope\", \"StErr\", \"t.value\", \"p.value\", \"Intercept\", \n\t\t\t\"F Stat\", \"numDF\",\"denDF\", \"Species\", \"adj.r.squ\")\n\nJYC\n}\n\n\n\n\n\n########## Columns that you can use to compare to earliest bloom date (taken from \"startDayOfYear\")\nnames(bl50)\n                \n#[11] \"startDayOfYear\"   [20] \"Raw_Precip\"              \n#[21] \"Avg_Hi\"                \"Med_Hi\"                  \n#[23] \"Avg_Lo\"                \"Med_Lo\"                  \n#[25] \"Av_Temp\"               \"Med_Temp\"  \n\n#run each of the 4 following codes separately\n\nJulBloomDate(\"Year\")\n\tYearJYC <- JYC \n\nJulBloomDate(\"Raw_Precip\")\n\tRawPrecipJYC <- JYC \n\nJulBloomDate(\"Avg_Hi\")\n\tAvgHiJYC <- JYC \n\nJulBloomDate(\"Avg_Lo\")\n\tAvgLoJYC <- JYC \n\n#then run each of these lines for each of the above & past in Excel\n\nwrite.table(JYC[1:100,], \"clipboard\", sep=\"\\t\", row.names = F, col.names = T)\nwrite.table(JYC[101:200,], \"clipboard\", sep=\"\\t\", row.names = F, col.names = T)\nwrite.table(JYC[201:290,], \"clipboard\", sep=\"\\t\", row.names = F, col.names = T)\n\n###\n\n\n## Categorize slope\nnames(JYC)\nnegsl <- subset(JYC, JYC$Slope < 0 & JYC$p.value < 0.05)\n\n# How many\nlength(negsl)\nnegsl$Species\n\n## Merge Year, precip, temp...\nmerge(YearJYC, RawPrecipJYC, by = \"Species\")\n\n\n\n# cannot put the whole table, \"JYC\" into Excel w/ ctrl V - too big\n\n# species where bloom date is signficantly getting earlier (JYC is the whole table):\nsubset(JYC, JYC$Slope < 0 & JYC$p.value < 0.05)\nearlier_bloom <- subset(JYC, JYC$Slope < 0 & JYC$p.value < 0.05)\n# puts table \"earlier_bloom\" into Exel w/ ctrl V\nwrite.table (earlier_bloom,\"clipboard\", sep = \"\\t\", row.names = FALSE, col.names = TRUE)\n\n# species where bloom date is signficantly getting later: None\nsubset(JYC, JYC$Slope > 0 & JYC$p.value < 0.05)\nlater_bloom <- subset(JYC, JYC$Slope > 0 & JYC$p.value < 0.05)\n# puts table \"later_bloom\" into Exel w/ ctrl V\nwrite.table (later_bloom,\"clipboard\", sep = \"\\t\", row.names = FALSE, col.names = TRUE)\n\n\n#################\t###################################### ######################### ############################\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1446061590979.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2235780156",
    "id" : "32AE5692",
    "lastKnownWriteTime" : 1425334360,
    "path" : "Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_QGIS Projects/Alpine Phenology Project/R_code_AlpinePhen/BloomByCode_medl.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}